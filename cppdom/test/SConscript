#!python
Import('baseEnv cppunit_options cppdom_pkg buildDir')

import os
pj = os.path.join

test_env = cppdom_pkg.getEnv().Copy()
test_env.Append(CPPPATH = ['#', '#test'],
                LIBPATH = [pj('#', buildDir, 'cppdom')],
                LIBS = ['cppdom'])

tests = Split("""
   maketree
   nodetest
   parsetest
""")

for t in tests:
   test_prog = cppdom_pkg.createProgram(t, test_env, 'test/cppdom')
   test_prog.addSources([t+'.cpp'])
   test_prog.build()

subdirs = []
if cppunit_options.isAvailable():
   subdirs.append('suite')
SConscript(dirs = subdirs)
